<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>DRGB Pay | Economía del Clan</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Rajdhani:wght@600&display=swap" rel="stylesheet">
    <style>
        :root {
            --drgb-purple: #8B00FF;
            --drgb-cyan: #00FFFF;
            --drgb-dark: #1a1a2e;
            --drgb-gray: #16213e;
            --text-light: #e0e0e0;
            --success: #00ff9d;
            --error: #ff006a;
            --admin-red: #ff3366;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        #particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }

        header {
            background: rgba(10, 10, 30, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--drgb-purple);
            padding: 16px 24px;
            position: sticky; top: 0; z-index: 1000;
        }

        .header-container {
            max-width: 1280px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
        }

        .logo {
            font-family: 'Orbitron', sans-serif; font-size: 28px; font-weight: 900;
            color: var(--drgb-cyan); text-shadow: 0 0 10px var(--drgb-cyan);
        }

        .logo span {
            background: linear-gradient(45deg, var(--drgb-purple), var(--drgb-cyan));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .user-info {
            display: flex; align-items: center; gap: 12px; font-size: 15px;
        }

        .user-avatar {
            width: 36px; height: 36px; border-radius: 50%;
            background: var(--drgb-purple); display: flex; align-items: center;
            justify-content: center; font-weight: bold; color: white;
        }

        .logout-btn {
            background: transparent; border: 1px solid var(--error);
            color: var(--error); padding: 6px 12px; border-radius: 6px;
            cursor: pointer; font-size: 13px;
        }

        .admin-btn {
            background: var(--admin-red); color: white; padding: 6px 12px;
            border-radius: 6px; cursor: pointer; font-size: 13px; display: none;
        }

        .auth-container {
            min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;
        }

        .auth-card {
            background: var(--drgb-gray); border: 1px solid var(--drgb-purple);
            border-radius: 16px; max-width: 420px; width: 100%; padding: 40px;
            box-shadow: 0 0 30px rgba(139, 0, 255, 0.3);
        }

        .auth-title {
            font-family: 'Orbitron', sans-serif; font-size: 32px; text-align: center;
            margin-bottom: 30px; background: linear-gradient(45deg, var(--drgb-cyan), var(--drgb-purple));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        input, select {
            width: 100%; padding: 12px 16px; background: rgba(255,255,255,0.05);
            border: 1px solid rgba(139,0,255,0.3); border-radius: 8px; color: white;
            font-size: 16px; margin-bottom: 15px;
        }

        input:focus { outline: none; border-color: var(--drgb-cyan); box-shadow: 0 0 15px rgba(0,255,255,0.3); }

        .btn-auth {
            width: 100%; padding: 14px; font-size: 18px; font-weight: bold;
            background: linear-gradient(45deg, var(--drgb-purple), var(--drgb-cyan));
            color: white; border: none; border-radius: 8px; cursor: pointer;
        }

        .switch-auth {
            text-align: center; margin-top: 20px; font-size: 14px; color: #999;
        }

        .switch-auth a { color: var(--drgb-cyan); font-weight: bold; text-decoration: none; }

        .dashboard { display: none; padding: 40px 20px; }

        .balance-card {
            background: linear-gradient(135deg, var(--drgb-purple), var(--drgb-cyan));
            border-radius: 16px; padding: 30px; text-align: center; max-width: 500px;
            margin: 0 auto 40px; box-shadow: 0 0 30px rgba(139, 0, 255, 0.5);
        }

        .balance-amount {
            font-family: 'Orbitron', sans-serif; font-size: 48px; font-weight: 900; color: white;
        }

        .actions {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px; max-width: 1000px; margin: 0 auto 40px;
        }

        .action-card {
            background: var(--drgb-gray); border: 1px solid var(--drgb-purple);
            border-radius: 12px; padding: 25px; text-align: center; cursor: pointer;
            transition: all 0.3s;
        }

        .action-card:hover {
            transform: translateY(-8px); box-shadow: 0 0 25px rgba(139, 0, 255, 0.4);
            border-color: var(--drgb-cyan);
        }

        .action-icon { font-size: 36px; margin-bottom: 15px; }

        .transactions {
            max-width: 900px; margin: 0 auto;
        }

        .transaction {
            background: var(--drgb-gray); border-left: 4px solid var(--drgb-cyan);
            padding: 15px; border-radius: 8px; margin-bottom: 12px;
            display: flex; justify-content: space-between; align-items: center;
            font-size: 15px;
        }

        .transaction.sent { border-left-color: var(--error); }

        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); z-index: 2000;
            align-items: center; justify-content: center; padding: 20px;
        }

        .modal-content {
            background: var(--drgb-gray); border: 1px solid var(--drgb-purple);
            border-radius: 16px; max-width: 500px; width: 100%; padding: 30px;
            position: relative;
        }

        .close-modal {
            position: absolute; top: 15px; right: 20px; font-size: 24px;
            cursor: pointer; color: #999;
        }

        .admin-panel { display: none; padding: 40px 20px; }

        .users-table {
            max-width: 1000px; margin: 0 auto; background: var(--drgb-gray);
            border: 1px solid var(--drgb-purple); border-radius: 12px; overflow: hidden;
        }

        table { width: 100%; border-collapse: collapse; }
        th { background: rgba(139,0,255,0.2); padding: 15px; text-align: left; color: var(--drgb-cyan); }
        td { padding: 12px 15px; border-top: 1px solid rgba(139,0,255,0.1); }
        .hash { font-family: monospace; font-size: 12px; color: #aaa; word-break: break-all; }

        footer { text-align: center; padding: 30px; color: #555; font-size: 13px; margin-top: 60px; }
    </style>
</head>
<body>

    <canvas id="particles"></canvas>

    <!-- Auth -->
    <div id="auth-container" class="auth-container">
        <div id="login-card" class="auth-card">
            <h2 class="auth-title">INICIAR SESIÓN</h2>
            <input type="text" id="login-user" placeholder="Usuario" />
            <input type="password" id="login-pass" placeholder="Contraseña" />
            <button class="btn-auth" onclick="login()">ACCEDER</button>
            <div class="switch-auth">
                ¿Nuevo? <a href="#" onclick="showRegister()">Regístrate</a>
            </div>
        </div>

        <div id="register-card" class="auth-card" style="display:none;">
            <h2 class="auth-title">REGISTRO</h2>
            <input type="text" id="reg-user" placeholder="Usuario" />
            <input type="password" id="reg-pass" placeholder="Contraseña (mín. 6)" />
            <button class="btn-auth" onclick="register()">CREAR CUENTA</button>
            <div class="switch-auth">
                ¿Ya tienes cuenta? <a href="#" onclick="showLogin()">Inicia sesión</a>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" class="dashboard">
        <header>
            <div class="header-container">
                <div class="logo"><span>DRGB</span> Pay</div>
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">U</div>
                    <span id="user-name">Cargando...</span>
                    <button class="admin-btn" id="admin-btn" onclick="showAdmin()">ADMIN</button>
                    <button class="logout-btn" onclick="logout()">Salir</button>
                </div>
            </div>
        </header>

        <div class="balance-card">
            <div>SALDO</div>
            <div class="balance-amount" id="balance">$0.00</div>
        </div>

        <div class="actions">
            <div class="action-card" onclick="openModal('send')">
                <div class="action-icon">Up Arrow</div>
                <div>Enviar DRGB</div>
            </div>
            <div class="action-card" onclick="openModal('request')">
                <div class="action-icon">Down Arrow</div>
                <div>Solicitar</div>
            </div>
        </div>

        <div class="transactions">
            <h3 style="color:var(--drgb-cyan); margin-bottom:20px; text-align:center;">TRANSACCIONES</h3>
            <div id="transaction-list"></div>
        </div>

        <footer>DRGB Pay | Economía privada del clan | Solo para miembros</footer>
    </div>

    <!-- Admin Panel -->
    <div id="admin-panel" class="admin-panel">
        <button class="logout-btn" style="position:fixed; top:20px; right:20px;" onclick="showDashboard()">VOLVER</button>
        <h1 style="text-align:center; color:var(--drgb-cyan); margin-bottom:30px;">ADMIN PANEL - ELPEPEXD2371</h1>
        <div class="users-table">
            <table>
                <thead>
                    <tr><th>Usuario</th><th>Registrado</th><th>Contraseña (SHA-256)</th></tr>
                </thead>
                <tbody id="admin-users"></tbody>
            </table>
        </div>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">×</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        // SHA-256
        async function sha256(str) {
            const encoder = new TextEncoder();
            const data = encoder.encode(str);
            const hash = await crypto.subtle.digest('SHA-256', data);
            return Array.from(new Uint8Array(hash))
                .map(b => b.toString(16).padStart(2, '0'))
                .join('');
        }

        // INICIALIZAR USUARIOS (ADMIN FIJO)
        let users = JSON.parse(localStorage.getItem('drgb_users')) || {};
        if (!users['ElpepexD2371']) {
            (async () => {
                const hash = await sha256('juan2010');
                users['ElpepexD2371'] = {
                    passHash: hash,
                    balance: 999999,
                    registered: new Date().toLocaleString(),
                    transactions: []
                };
                localStorage.setItem('drgb_users', JSON.stringify(users));
            })();
        }

        let currentUser = null;

        // Auth
        function showLogin() {
            document.getElementById('login-card').style.display = 'block';
            document.getElementById('register-card').style.display = 'none';
        }

        function showRegister() {
            document.getElementById('login-card').style.display = 'none';
            document.getElementById('register-card').style.display = 'block';
        }

        async function register() {
            const user = document.getElementById('reg-user').value.trim();
            const pass = document.getElementById('reg-pass').value;

            if (!user || pass.length < 6) return alert('Usuario y contraseña (mín. 6) requeridos.');
            if (users[user]) return alert('Usuario ya existe.');

            const passHash = await sha256(pass);
            users[user] = {
                passHash,
                balance: 100,
                registered: new Date().toLocaleString(),
                transactions: []
            };

            localStorage.setItem('drgb_users', JSON.stringify(users));
            alert('¡Cuenta creada! Saldo inicial: $100');
            showLogin();
        }

        async function login() {
            const user = document.getElementById('login-user').value.trim();
            const pass = document.getElementById('login-pass').value;
            const data = users[user];

            if (!data) return alert('Usuario no encontrado.');
            const inputHash = await sha256(pass);
            if (inputHash !== data.passHash) return alert('Contraseña incorrecta.');

            currentUser = user;
            localStorage.setItem('drgb_current', user);
            loadDashboard();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('drgb_current');
            document.getElementById('auth-container').style.display = 'flex';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('admin-panel').style.display = 'none';
        }

        function loadDashboard() {
            document.getElementById('auth-container').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';

            const data = users[currentUser];
            document.getElementById('user-name').textContent = currentUser;
            document.getElementById('user-avatar').textContent = currentUser[0].toUpperCase();
            document.getElementById('balance').textContent = `$${data.balance.toFixed(2)}`;
            document.getElementById('admin-btn').style.display = currentUser === 'ElpepexD2371' ? 'block' : 'none';

            renderTransactions();
        }

        function showAdmin() {
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('admin-panel').style.display = 'block';
            renderAdmin();
        }

        function showDashboard() {
            document.getElementById('admin-panel').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
        }

        function renderAdmin() {
            const tbody = document.getElementById('admin-users');
            tbody.innerHTML = '';
            for (const [user, data] of Object.entries(users)) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${user}</strong></td>
                    <td>${data.registered}</td>
                    <td class="hash">${data.passHash}</td>
                `;
                tbody.appendChild(row);
            }
        }

        // Transacciones
        function openModal(type) {
            const modal = document.getElementById('modal');
            const body = document.getElementById('modal-body');
            modal.style.display = 'flex';

            if (type === 'send') {
                body.innerHTML = `
                    <h3 style="color:var(--drgb-cyan);">Enviar DRGB</h3>
                    <input type="text" id="send-to" placeholder="Usuario destino" />
                    <input type="number" id="send-amount" placeholder="Cantidad" step="0.01" />
                    <button class="btn-auth" style="margin-top:10px;" onclick="sendMoney()">Enviar</button>
                `;
            } else if (type === 'request') {
                body.innerHTML = `
                    <h3 style="color:var(--drgb-cyan);">Solicitar DRGB</h3>
                    <p>Comparte este enlace:</p>
                    <input type="text" value="https://drgb.gg/pay?to=${currentUser}" readonly style="text-align:center;" />
                    <button class="btn-auth" onclick="navigator.clipboard.writeText('https://drgb.gg/pay?to=${currentUser}')">Copiar</button>
                `;
            }
        }

        function closeModal() { document.getElementById('modal').style.display = 'none'; }

        function sendMoney() {
            const to = document.getElementById('send-to').value.trim();
            const amount = parseFloat(document.getElementById('send-amount').value);

            if (!users[to]) return alert('Usuario no existe.');
            if (amount <= 0 || users[currentUser].balance < amount) return alert('Fondos insuficientes.');

            users[currentUser].balance -= amount;
            users[to].balance += amount;

            const date = new Date().toLocaleString();
            users[currentUser].transactions.unshift({ type: 'sent', to, amount, date });
            users[to].transactions.unshift({ type: 'received', from: currentUser, amount, date });

            localStorage.setItem('drgb_users', JSON.stringify(users));
            loadDashboard();
            closeModal();
            alert(`¡$${amount} enviados a ${to}!`);
        }

        function renderTransactions() {
            const list = document.getElementById('transaction-list');
            const txs = users[currentUser].transactions.slice(0, 20);
            list.innerHTML = txs.length ? txs.map(tx => {
                const sign = tx.type === 'sent' ? '-' : '+';
                const color = tx.type === 'sent' ? 'var(--error)' : 'var(--success)';
                const icon = tx.type === 'sent' ? 'Up Arrow' : 'Down Arrow';
                const other = tx.type === 'sent' ? tx.to : tx.from;
                return `<div class="transaction ${tx.type}">
                    <div><strong>${icon} ${other}</strong><br><small>${tx.date}</small></div>
                    <div style="color:${color}">${sign}$${tx.amount.toFixed(2)}</div>
                </div>`;
            }).join('') : '<p style="text-align:center; color:#666;">Sin transacciones.</p>';
        }

        // Particles
        window.onload = () => {
            const saved = localStorage.getItem('drgb_current');
            if (saved && users[saved]) { currentUser = saved; loadDashboard(); }

            const canvas = document.getElementById('particles');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            const particles = Array.from({length: 50}, () => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 2 + 1,
                speed: Math.random() * 1 + 0.5,
                color: Math.random() > 0.5 ? 'rgba(139,0,255,0.5)' : 'rgba(0,255,255,0.5)'
            }));

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    ctx.beginPath(); ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2);
                    ctx.fillStyle = p.color; ctx.fill();
                    p.y -= p.speed; if (p.y < 0) p.y = canvas.height;
                });
                requestAnimationFrame(animate);
            }
            animate();
        };

        // 100 IDEAS MASIVAS (en consola)
        console.log("%c100 IDEAS MASIVAS PARA DRGB", "color: #8B00FF; font-size: 18px; font-weight: bold;");
        console.log("%c1. Tratos secretos entre miembros\n2. Pago por favores\n3. Deudas con intereses\n4. Regalos anónimos\n5. Apuestas privadas...", "color: #00FFFF;");
    </script>
</body>
</html>

